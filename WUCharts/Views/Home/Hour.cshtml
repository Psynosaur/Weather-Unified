@using Newtonsoft.Json
@model List<WURequest.Models.Observations>
@{
    var cnt = Model.Select(x => true).Count();
    double? maxTemp = Model.Any() ? Model.Select(x => x.TempOutCur).ToList().Max() : 0;
    double? minTemp = Model.Any() ? Model.Select(x => x.TempOutCur).ToList().Min() : 0;
    double? maxHum = Model.Any() ? Model.Select(x => x.HumOutCur).ToList().Max() : 0;
    double? minHum = Model.Any() ? Model.Select(x => x.HumOutCur).ToList().Min() : 0;
    double? maxDew = Model.Any() ? Model.Select(x => x.DewCur).ToList().Max() : 0;
    double? minDew = Model.Any() ? Model.Select(x => x.DewCur).ToList().Min() : 0;
    double? minRain = Model.Any() ? Model.Select(x => x.RainRateCur).ToList().Min() : 0;
    var avgTemp = Model.Any() ? Model.Select(x => x.TempOutCur).ToList().Average() : 0;
    var avgHum = Model.Any() ? Model.Select(x => x.HumOutCur).ToList().Average() : 0;
    var avgDew = Model.Any() ? Model.Select(x => x.DewCur).ToList().Average() : 0;
    var avgRain = Model.Any() ? Model.Select(x => x.RainDay).ToList().Average() : 0;
    string niks = "--";

    var rainHour = Model.Any() ? Model.Select(x => x.RainDay).Last() - Model.Select(x => x.RainDay).First() : 0;
    //ViewData["Title"] = "Temp Past Hour : " + DateTime.Now.ToString("f");
}

<div class="container-fluid">
    <h2>Hourly Stats</h2>
    @if (cnt > 0)
    {
        <div class="container-fluid">
            <table>
                <tr>
                    <td>
                        <br/>
                    </td>
                    <td>
                        <br/>
                    </td>
                    <th width="100px">
                        High
                    </th>
                    <th width="100px">
                        Low
                    </th>
                    <th width="100px">
                        Average
                    </th>
                </tr>
                <tr>
                    <td>
                        <br/>
                    </td>
                </tr>
                <tr>
                    <th height="25px" width="100px">
                        Temp
                    </th>
                    <td>
                        <p></p>
                    </td>
                    <td>
                        <strong>@maxTemp</strong> &#176C
                    </td>
                    <td>
                        <strong>@minTemp</strong> &#176C
                    </td>
                    <td>
                        <strong>@avgTemp.ToString("#.00")</strong> &#176C
                    </td>
                </tr>
                <tr>
                    <th height="25px" width="100px">
                        Humidity
                    </th>
                    <td>
                        <p></p>
                    </td>
                    <td>
                        <strong>@maxHum</strong> %
                    </td>
                    <td>
                        <strong>@minHum</strong> %
                    </td>
                    <td>
                        <strong>@avgHum.ToString("#.00")</strong> %
                    </td>
                </tr>
                <tr>
                    <th height="25px" width="100px">
                        Dew Point
                    </th>
                    <td>
                        <p></p>
                    </td>
                    <td>
                        <strong>@maxDew</strong> &#176C
                    </td>
                    <td>
                        <strong>@minDew</strong> &#176C
                    </td>
                    <td>
                        <strong>@avgDew.ToString("#.00")</strong> &#176C
                    </td>
                </tr>
                <tr>
                    <th height="25px" width="100px">
                        Precipitation
                    </th>
                    <td>
                        <p></p>
                    </td>
                    <td>
                        <strong>@rainHour</strong> mm
                    </td>
                    <td>
                        @if (minRain > 0)
                        {
                            <strong>
                                @minRain
                            </strong>
                        }
                        else
                        {
                            <strong>
                                @niks
                            </strong>
                        }
                        mm
                    </td>
                    <td>
                        @if (rainHour> 0)
                        {
                            <strong>
                                @avgRain.ToString("#.00")
                            </strong>
                        }
                        else
                        {
                            <strong>
                                @niks
                            </strong>
                        }
                        mm
                    </td>
                </tr>
            </table>
            <div id="chartemp" style="height:300px;"></div>
            <div id="chartminmax" style="height:300px;"></div>
            <div id="chartwind" style="height:300px;"></div>
            <div id="chartrain" style="height:300px;"></div>
            <div id="chartpressure" style="height:300px;"></div>
        </div>
    }
    @cnt total records
</div>

<script src="//www.amcharts.com/lib/4/core.js"></script>
<script src="//www.amcharts.com/lib/4/charts.js"></script>
<script src="https://www.amcharts.com/lib/4/themes/dark.js"></script>
<script type="text/javascript">
    var hrs = 0;
    var modeldata = @Html.Raw(JsonConvert.SerializeObject(Model));
</script>
<script type="text/javascript" src="~/js/amcharts.js"></script>